using System;
using System.IO;
using System.Security.Cryptography;
using System.Collections.Generic;

namespace AntiMalwareScan
{
    class Program
    {
        static void Main(string[] args)
        {
            string folderPath = @"C:\Users\{USER}\Downloads";
            List<string> knownMalwareHashes = new List<string>
            {
                "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6Q7R8S9",
                "9S8R7Q6P5O4N3M2L1K0J9I8H7G6F5E4D3C2B1A",
                "Z1Y2X3W4V5U6T7S8R9Q0P1O2N3M4L5K6J7I8H9G"
            };

            ScanFolder(folderPath, knownMalwareHashes);
        }

        static void ScanFolder(string folderPath, List<string> knownMalwareHashes)
        {
            try
            {
                foreach (string file in Directory.GetFiles(folderPath))
                {
                    if (IsFileMalware(file, knownMalwareHashes))
                    {
                        Console.WriteLine("Malware detected: " + file);
                    }
                    else 
                    {
                        Console.WriteLine("Malware not detected: " + file);
                    }
                }

                foreach (string subfolder in Directory.GetDirectories(folderPath))
                {
                    ScanFolder(subfolder, knownMalwareHashes);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine("Error scanning folder: " + ex.Message);
            }
        }

        static bool IsFileMalware(string file, List<string> knownMalwareHashes)
        {
            using (var hash = SHA256.Create())
            {
                using (var stream = File.OpenRead(file))
                {
                    var fileHash = BitConverter.ToString(hash.ComputeHash(stream)).Replace("-", "").ToLowerInvariant();
                    return knownMalwareHashes.Contains(fileHash);
                }
            }
        }
    }
}
